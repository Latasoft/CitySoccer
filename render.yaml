# Render Build Configuration
# This file tells Render how to build and deploy your Next.js app

services:
  - type: web
    name: city-soccer
    env: node
    region: oregon # o usa 'singapore' si prefieres
    plan: standard # $25/mes - 2GB RAM, 1 CPU

    # Build Command
    buildCommand: node scripts/ensure-directories.js && npm run build

    # Start Command
    startCommand: npm run start

    # Node.js Version
    buildFilter:
      paths:
        - "**"

    # Environment Variables
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_PUBLIC_SUPABASE_URL
        sync: false
      - key: NEXT_PUBLIC_SUPABASE_ANON_KEY
        sync: false

    # PERSISTENT DISK - Solo para contenido editable del admin
    # Monta solo /uploads y /content para preservar ediciones entre deploys
    # Las imágenes estáticas vienen del repositorio Git
    disks:
      - name: citysoccer-uploads
        mountPath: /opt/render/project/src/public/uploads
        sizeGB: 3
      - name: citysoccer-content
        mountPath: /opt/render/project/src/public/content
        sizeGB: 1

    # Auto-Deploy
    autoDeploy: true

    # Health Check
    healthCheckPath: /
